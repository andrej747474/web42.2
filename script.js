const apiKey='c421857110df2b1e6445d5eafd267825';const cityInput=document.getElementById('city-input');const searchBtn=document.getElementById('search-btn');const weatherInfo=document.getElementById('weather-info');const loading=document.getElementById('loading');const error=document.getElementById('error');const cityName=document.getElementById('city-name');const temperature=document.getElementById('temperature');const weatherDescription=document.getElementById('weather-description');const weatherIcon=document.getElementById('weather-icon');const feelsLike=document.getElementById('feels-like');const humidity=document.getElementById('humidity');const windSpeed=document.getElementById('wind-speed');const defaultCities=document.querySelectorAll('.default-city');function showError(t){error.textContent=t,error.style.display='block',loading.style.display='none',weatherInfo.style.display='none'}function hideError(){error.style.display='none'}function showLoading(){loading.style.display='block',weatherInfo.style.display='none',hideError()}function showWeather(){loading.style.display='none',weatherInfo.style.display='block',hideError()}function getWeatherIcon(t){return t>=200&&t<300?'<i class="fas fa-bolt"></i>':t>=300&&t<500?'<i class="fas fa-cloud-rain"></i>':t>=500&&t<600?'<i class="fas fa-rain"></i>':t>=600&&t<700?'<i class="fas fa-snowflake"></i>':t>=700&&t<800?'<i class="fas fa-smog"></i>':800===t?'<i class="fas fa-sun"></i>':t>800?'<i class="fas fa-cloud"></i>':'<i class="fas fa-cloud-sun"></i>'}function getWeather(t){showLoading();const e=`https://api.openweathermap.org/data/2.5/weather?q=${encodeURIComponent(t)}&units=metric&lang=ru&appid=${apiKey}`;fetch(e).then(t=>{if(!t.ok){if(404===t.status)throw new Error('Город не найден. Проверьте правильность написания.');if(401===t.status)throw new Error('Проблема с API ключом.');throw new Error('Ошибка соединения с сервером.')}return t.json()}).then(t=>{displayWeather(t)}).catch(t=>{showError('Ошибка: '+t.message)})}function displayWeather(t){cityName.textContent=t.name,temperature.textContent=Math.round(t.main.temp)+'°C',weatherDescription.textContent=t.weather[0].description,weatherIcon.innerHTML=getWeatherIcon(t.weather[0].id),feelsLike.textContent=Math.round(t.main.feels_like)+'°C',humidity.textContent=t.main.humidity+'%',windSpeed.textContent=t.wind.speed+' м/с',showWeather()}function saveLastCity(t){localStorage.setItem('lastWeatherCity',t)}function loadLastCity(){const t=localStorage.getItem('lastWeatherCity');return t?t:'Москва'}searchBtn.addEventListener('click',function(){const t=cityInput.value.trim();t&&(getWeather(t),saveLastCity(t),cityInput.value='')}),cityInput.addEventListener('keypress',function(t){'Enter'===t.key&&(t=this.value.trim())&&(getWeather(t),saveLastCity(t),this.value='')}),defaultCities.forEach(t=>{t.addEventListener('click',function(){const t=this.getAttribute('data-city');getWeather(t),saveLastCity(t)})}),window.addEventListener('DOMContentLoaded',function(){getWeather(loadLastCity())});
